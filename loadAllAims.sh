for a in */; do cd $a ; nAt=$(( $(cat *.xyz | wc -l) - 2 )) ; grep "| Total energy of the DFT / Hartree-Fock s.c.f. calculation      : " aims.out | awk '{print $(NF-1)}' >> energy ; grep "Hirshfeld charge   " aims.out | awk '{print $5}'  >> hirshfeld ; grep "|                   0   0 " aims.out | tail -${nAt} | awk '{print $4}' >> aims_charges ; sed -n '/Total atomic forces/,/------------------------------------/p' aims.out | grep '^  |' | awk '{print $3, $4, $5}' >> forces |  python -c "from ase.io import read, write; import numpy as np; mols = read('${a::-1}.xyz', format='xyz'); hirshfeld_data = np.loadtxt('hirshfeld'); aims_charges_data = np.loadtxt('aims_charges'); energy_data = np.loadtxt('energy'); forces_data = np.loadtxt('forces'); mols.arrays['hirshfeld'] = hirshfeld_data; mols.arrays['aims_charges'] = aims_charges_data; mols.arrays['forces'] = forces_data; mols.info['energy'] = energy_data; write('loaded_file.xyz', mols)" ; cat loaded_file.xyz >> ../allStructures.xyz ; cd .. ; done
